import pandas as pd
import numpy as np
import matplotlib.pyplot as plt 
import csv
import os

from def_mots_chelous import louche, graph, louche_graph

SAMPLE_DATA_PATH = os.path.join(os.getcwd() , "sample_dataset.csv")

csv_data = pd.read_csv(SAMPLE_DATA_PATH, sep = ";")

# INFOS GENERALES
#-----------------------------------------------------------------------------------------------------------------------------------------------

print(len(csv_data))                                                        # 2574 lignes

print("")

print(csv_data.columns)                                                     # Affiche les différentes colonnes

print("")


# TEST MOTS CHELOUS
#-----------------------------------------------------------------------------------------------------------------------------------------------

louche("money")
graph("money")
# louche_graph("money")

#-----------------------------------------------------------------------------------------------------------------------------------------------


louche("trade")
louche("million")
louche("problem")
louche("covering")
louche("money")
louche("transaction")
louche("validation")
louche("bank transfert")
louche("action")
louche("stock exchange")
louche("market")
louche("transfert")

# CREATION CSV DE STOCKAGE DES MAILS SUSPECTS CONTENANT LE TERME "STOCK EXCHANGE"
#-----------------------------------------------------------------------------------------------------------------------------------------------

a = (csv_data[csv_data['stock exchange'] == True])                                 # Les résultats de la colonne stock exchange étants "True" passe dans la variable a 
a = a.drop(["trade","mail_folder", "million", "problem", "covering", "money", "cover", "market", "transfert","transaction","validation","bank transfert","action","cleanedtext"], axis = 1)
b = (csv_data[csv_data['validation'] == True])
b = b.drop(["trade", "mail_folder","million", "problem", "covering", "money", "cover", "market", "transfert","transaction","stock exchange","bank transfert","action","cleanedtext"], axis = 1)
c = (csv_data[csv_data['million'] == True])
c = c.drop(["trade", "mail_folder", "problem", "covering", "money", "cover", "market", "transfert","transaction","validation","stock exchange","bank transfert","action","cleanedtext"], axis = 1)


print("")

a.to_csv('out.csv', index=True, sep = ";", mode = 'a')
b.to_csv('out.csv', index=True, sep = ";", mode = 'a')
c.to_csv('out.csv', index=True, sep = ";", mode = 'a')

# CREATION CSV DE STOCKAGE DES MAILS SUSPECTS CONTENANT LE TERME VALIDATION
#-----------------------------------------------------------------------------------------------------------------------------------------------

with open('out.csv', 'a',newline = '') as file:
    writer = csv.writer(file)
    writer.writerow([])
    writer.writerow(["Ces mails contiennent le mot 'stock exchange','validation' ou 'million' "])




